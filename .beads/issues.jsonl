{"id":"cobbler-17c","title":"GH-44: Recurring: Full requirements coverage, test coverage, and code inspection audit","description":"Perform a comprehensive audit of the cobbler-scaffold codebase covering requirements traceability, test coverage, and code quality. Coverage baseline: 31.6% (up from 24.8% at previous audit #39).\n\nGitHub: petar-djukic/cobbler-scaffold#44","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-27T00:21:16Z","created_by":"petardjukic","updated_at":"2026-02-27T00:27:20Z","closed_at":"2026-02-27T00:27:20Z","close_reason":"All children completed"}
{"id":"cobbler-17c.1","title":"Fix error handling and race condition issues","description":"deliverable_type: code\n\nrequired_reading:\n  - pkg/orchestrator/orchestrator.go (logf, setPhase, setGeneration global state)\n  - pkg/orchestrator/stitch.go (resetTask, cleanupWorktree, createWorktree)\n  - pkg/orchestrator/measure.go (force import error handling)\n\nfiles:\n  - path: pkg/orchestrator/orchestrator.go\n    action: modify\n    note: Protect currentGeneration, currentPhase, phaseStart with sync.RWMutex\n  - path: pkg/orchestrator/stitch.go\n    action: modify\n    note: Log resetTask branch delete error, fix cleanupWorktree ordering, return createWorktree MkdirAll error\n\nrequirements:\n  - id: R1\n    text: Protect logf global state reads (currentGeneration, currentPhase, phaseStart) with sync.RWMutex\n  - id: R2\n    text: Log error from gitForceDeleteBranch in resetTask instead of silently discarding\n  - id: R3\n    text: Return error from createWorktree when MkdirAll fails instead of logging and continuing\n  - id: R4\n    text: In cleanupWorktree only delete branch after worktree removal succeeds\n\nacceptance_criteria:\n  - id: AC1\n    text: No data races in logf when called concurrently with setPhase/setGeneration\n  - id: AC2\n    text: resetTask logs branch deletion errors\n  - id: AC3\n    text: createWorktree returns error on MkdirAll failure\n  - id: AC4\n    text: All existing tests pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-27T00:21:28Z","created_by":"petardjukic","updated_at":"2026-02-27T00:23:25Z","closed_at":"2026-02-27T00:23:25Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-17c.1","depends_on_id":"cobbler-17c","type":"parent-child","created_at":"2026-02-26T19:21:27Z","created_by":"petardjukic","metadata":"{}"}]}
{"id":"cobbler-17c.2","title":"Add unit tests for untested pure functions","description":"deliverable_type: code\n\nrequired_reading:\n  - pkg/orchestrator/version.go (readVersionConst, writeVersionConst)\n  - pkg/orchestrator/cobbler.go (historyDir, worktreeBasePath, saveHistoryStats, saveHistoryPrompt, saveHistoryLog, logLine)\n\nfiles:\n  - path: pkg/orchestrator/version_test.go\n    action: create\n    note: Tests for readVersionConst and writeVersionConst\n  - path: pkg/orchestrator/cobbler_test.go\n    action: modify\n    note: Tests for historyDir, worktreeBasePath, saveHistory*, logLine\n\nrequirements:\n  - id: R1\n    text: Test readVersionConst with valid file, missing file, and file without Version constant\n  - id: R2\n    text: Test writeVersionConst with valid replacement, missing file, and file without constant\n  - id: R3\n    text: Test historyDir with empty, absolute, and relative paths\n  - id: R4\n    text: Test worktreeBasePath returns expected temp directory path\n  - id: R5\n    text: Test saveHistoryStats, saveHistoryPrompt, saveHistoryLog write correct files and handle empty historyDir\n\nacceptance_criteria:\n  - id: AC1\n    text: All new tests pass\n  - id: AC2\n    text: All existing tests still pass\n  - id: AC3\n    text: Coverage improves from 31.6% baseline","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-27T00:21:37Z","created_by":"petardjukic","updated_at":"2026-02-27T00:25:00Z","closed_at":"2026-02-27T00:25:00Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-17c.2","depends_on_id":"cobbler-17c","type":"parent-child","created_at":"2026-02-26T19:21:37Z","created_by":"petardjukic","metadata":"{}"}]}
{"id":"cobbler-17c.3","title":"Write audit report and file follow-up issues","description":"deliverable_type: documentation\n\nrequired_reading:\n  - docs/audits/audit-2026-02-25-requirements.yaml (previous audit format)\n\nfiles:\n  - path: docs/audits/audit-2026-02-26-coverage-inspection.yaml\n    action: create\n    note: Audit report with coverage data, findings, and recommendations\n\nrequirements:\n  - id: R1\n    text: Record per-package coverage percentages and trend vs previous audit\n  - id: R2\n    text: List code issues found with severity and fix status\n  - id: R3\n    text: List untested critical paths with severity assessment\n  - id: R4\n    text: File GitHub issues for remaining work items not addressed in this audit\n\nacceptance_criteria:\n  - id: AC1\n    text: Audit report written to docs/audits/\n  - id: AC2\n    text: GitHub issues filed for remaining findings","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-27T00:21:46Z","created_by":"petardjukic","updated_at":"2026-02-27T00:27:10Z","closed_at":"2026-02-27T00:27:10Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-17c.3","depends_on_id":"cobbler-17c","type":"parent-child","created_at":"2026-02-26T19:21:45Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":29,"issue_id":"cobbler-17c.3","author":"petardjukic","text":"tokens: 45000","created_at":"2026-02-27T00:27:09Z"}]}
{"id":"cobbler-4z5","title":"GH-51: Add pre-cycle analyze step to cobbler workflow","description":"Add an analyze step that runs before measure and stitch in the cobbler workflow. This step inspects the codebase, records implementation status to a file in the scratch directory, and makes that status available to all subsequent operations.\n\nAcceptance Criteria:\n- An analyze step runs automatically before each measure and stitch cycle\n- Analysis results are written to a YAML file in the scratch directory\n- The analysis file is loaded into ProjectContext and visible in measure/stitch prompts\n- Claude can see which use cases are implemented vs. not when proposing and executing tasks\n- cobbler:reset cleans up the analysis file\n- The analyze step reuses existing CodeStatus() and Analyze() logic (no duplication)\n\nGitHub: petar-djukic/cobbler-scaffold#51","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T18:04:18Z","created_by":"petardjukic","updated_at":"2026-02-26T18:12:13Z","closed_at":"2026-02-26T18:12:13Z","close_reason":"All children completed"}
{"id":"cobbler-4z5.1","title":"Implement pre-cycle analysis and inject into project context","description":"deliverable_type: code\n\nRequired Reading:\n- pkg/orchestrator/analyze.go\n- pkg/orchestrator/codestatus.go\n- pkg/orchestrator/context.go\n- pkg/orchestrator/measure.go\n- pkg/orchestrator/generator.go\n- pkg/orchestrator/cobbler.go\n\nFiles to Create/Modify:\n- pkg/orchestrator/precycle.go (new)\n- pkg/orchestrator/analyze.go (refactor)\n- pkg/orchestrator/context.go (add Analysis field)\n- pkg/orchestrator/measure.go (wire RunPreCycleAnalysis)\n- pkg/orchestrator/generator.go (wire RunPreCycleAnalysis)\n\nRequirements:\n1. Refactor Analyze() to extract data gathering into collectAnalyzeResult() so the AnalyzeResult struct is reusable without printing\n2. Add AnalysisDoc struct combining AnalyzeResult summary and CodeStatusReport. YAML-serializable.\n3. Add RunPreCycleAnalysis() that calls collectAnalyzeResult() and computeCodeStatus(), writes AnalysisDoc to {ScratchDir}/analysis.yaml\n4. Add Analysis *AnalysisDoc field to ProjectContext\n5. In buildProjectContext(), load analysis.yaml into ctx.Analysis if present\n6. Call RunPreCycleAnalysis() at start of RunMeasure() and RunCycles()\n\nDesign Decisions:\n- Analysis is non-blocking: log warnings but do not fail the cycle\n- Analysis file is regenerated on every call\n- CobblerReset() already cleans .cobbler/ so no change needed\n\nAcceptance Criteria:\n- RunMeasure() and RunCycles() call RunPreCycleAnalysis() before main work\n- Analysis results written to .cobbler/analysis.yaml\n- buildProjectContext() loads analysis into ProjectContext.Analysis\n- mage analyze still works (refactor preserves behavior)\n- mage test:unit passes","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T18:04:27Z","created_by":"petardjukic","updated_at":"2026-02-26T18:10:38Z","closed_at":"2026-02-26T18:10:38Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-4z5.1","depends_on_id":"cobbler-4z5","type":"parent-child","created_at":"2026-02-26T13:04:27Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":23,"issue_id":"cobbler-4z5.1","author":"petardjukic","text":"tokens: 45000","created_at":"2026-02-26T18:10:38Z"}]}
{"id":"cobbler-4z5.2","title":"Add unit tests for pre-cycle analysis","description":"deliverable_type: code\n\nRequired Reading:\n- pkg/orchestrator/precycle.go\n- pkg/orchestrator/analyze_test.go\n- pkg/orchestrator/codestatus_test.go\n\nFiles to Create/Modify:\n- pkg/orchestrator/precycle_test.go (new)\n- pkg/orchestrator/analyze_test.go (add collectAnalyzeResult test)\n\nRequirements:\n1. Test collectAnalyzeResult() returns structured data without printing\n2. Test AnalysisDoc YAML marshaling/unmarshaling round-trip\n3. Test RunPreCycleAnalysis() writes analysis.yaml to scratch dir\n4. Test buildProjectContext() loads analysis file into ctx.Analysis when present and leaves nil when absent\n5. Edge cases: missing roadmap, empty test directory, scratch dir doesn't exist\n\nAcceptance Criteria:\n- All new functions have at least 3 test cases\n- mage test:unit passes","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T18:04:33Z","created_by":"petardjukic","updated_at":"2026-02-26T18:11:58Z","closed_at":"2026-02-26T18:11:58Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-4z5.2","depends_on_id":"cobbler-4z5","type":"parent-child","created_at":"2026-02-26T13:04:33Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":24,"issue_id":"cobbler-4z5.2","author":"petardjukic","text":"tokens: 15000","created_at":"2026-02-26T18:11:57Z"}]}
{"id":"cobbler-6e3","title":"GH-25: bd ready returns empty after stitch timeout (stale task state)","description":"After a stitch timeout (the Claude process is killed at max_time_sec), the beads task enters a state where bd ready cannot find it, even though bd show \u003cid\u003e shows it as READY. This requires manual intervention to re-queue the task.\n\nRoot cause: resetTask(), recoverStaleBranches(), and resetOrphanedIssues() call bdUpdateStatus(id, \"ready\") but \"ready\" is not a valid beads status. The bd CLI silently accepts it, but bd ready only returns issues with status \"open\". The task becomes invisible.\n\nFix: Change \"ready\" to \"open\" in all three locations, add error handling, and add tests.\n\nGitHub: petar-djukic/cobbler-scaffold#25","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T01:17:55Z","created_by":"petardjukic","updated_at":"2026-02-26T01:33:36Z","closed_at":"2026-02-26T01:33:36Z","close_reason":"Closed"}
{"id":"cobbler-6e3.2","title":"Fix status value and add error handling in task reset paths","description":"## Required Reading\n- pkg/orchestrator/stitch.go (resetTask, recoverStaleBranches, resetOrphanedIssues)\n- pkg/orchestrator/commands.go (bdUpdateStatus)\n\n## Files to Modify\n- pkg/orchestrator/stitch.go\n\n## Requirements\n1. Replace \"ready\" with \"open\" in all 3 bdUpdateStatus calls:\n   - Line 729: resetTask()\n   - Line 225: recoverStaleBranches()\n   - Line 261: resetOrphanedIssues()\n2. Add error checking in resetTask() — currently ignores return from bdUpdateStatus\n3. Add a constant (statusOpen = \"open\") to avoid repeated string literals\n4. Update the comment on line 22 that mentions \"ready\"\n\n## Design Decisions\n- Use a package-level constant for status strings to prevent future typos\n- Log warnings on bdUpdateStatus failure (don't fail hard — cleanup should continue)\n\n## Acceptance Criteria\n- All task reset paths use \"open\" status\n- resetTask logs warning if bdUpdateStatus fails\n- No string literal \"ready\" used as a beads status value\n- Code compiles: go build ./...","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T01:18:10Z","created_by":"petardjukic","updated_at":"2026-02-26T01:24:37Z","closed_at":"2026-02-26T01:24:37Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-6e3.2","depends_on_id":"cobbler-6e3","type":"parent-child","created_at":"2026-02-25T20:18:10Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":1,"issue_id":"cobbler-6e3.2","author":"petardjukic","text":"tokens: 0","created_at":"2026-02-26T01:24:37Z"}]}
{"id":"cobbler-6e3.3","title":"Add tests for stitch timeout recovery","description":"## Required Reading\n- pkg/orchestrator/stitch.go (resetTask, resetOrphanedIssues, recoverStaleTasks)\n- tests/rel01.0/internal/testutil/testutil.go (CountReadyIssues, CreateIssue helpers)\n- Existing *_test.go files in pkg/orchestrator/\n\n## Files to Create/Modify\n- pkg/orchestrator/stitch_test.go (new or existing)\n\n## Requirements\n1. Test that resetTask sets status to \"open\" (verifiable via bd ready)\n2. Test that resetOrphanedIssues resets orphaned tasks to \"open\"\n3. Test that after reset, bd ready returns the task\n4. Test error case: verify logging when bdUpdateStatus fails\n\n## Design Decisions\n- Use bd CLI in tests (integration-style) since the code under test calls bd as external process\n- May need test helpers to initialize and tear down beads state\n\n## Acceptance Criteria\n- Tests pass: go test ./pkg/orchestrator/...\n- Tests cover the timeout → reset → bd ready cycle\n- No flaky tests (deterministic state setup/teardown)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T01:18:18Z","created_by":"petardjukic","updated_at":"2026-02-26T01:33:04Z","closed_at":"2026-02-26T01:33:04Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-6e3.3","depends_on_id":"cobbler-6e3","type":"parent-child","created_at":"2026-02-25T20:18:17Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":2,"issue_id":"cobbler-6e3.3","author":"petardjukic","text":"tokens: 0","created_at":"2026-02-26T01:33:03Z"}]}
{"id":"cobbler-anw","title":"GH-48: Add code-level release status tracking to measure","description":"The road-map.yaml file tracks specification status (use case completion at the documentation level), but during code generation the road-map is checked as if it reflects implementation status. There is currently no mechanism to verify whether the code actually implements what the specifications describe.\n\nThe measure target (or a new companion check) should inspect the codebase to determine:\n\n1. Code status per use case: For each use case in the roadmap, check whether corresponding Go test files exist in tests/ and whether they pass, indicating the use case is implemented.\n2. Release readiness: For each release in road-map.yaml, determine whether all use cases assigned to that release have passing tests, indicating the release is code-complete.\n3. Spec vs code gap reporting: Report discrepancies between specification status (road-map.yaml says \"done\") and code status (tests missing or failing).\n\nAcceptance Criteria:\n- mage measure (or a dedicated target) reports per-use-case code status (implemented, partial, not started) based on test file existence and test results\n- Per-release code readiness is reported (all use cases passing, some failing, none implemented)\n- Gaps between spec status in road-map.yaml and actual code status are surfaced\n- Output distinguishes between \"specification done\" and \"code done\" for each use case and release\n\nGitHub: petar-djukic/cobbler-scaffold#48","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T13:34:52Z","created_by":"petardjukic","updated_at":"2026-02-26T13:39:33Z","closed_at":"2026-02-26T13:39:33Z","close_reason":"All children completed"}
{"id":"cobbler-anw.2","title":"Implement code status scanning and reporting","description":"deliverable_type: code\n\nRequired Reading:\n- pkg/orchestrator/analyze.go — existing cross-artifact analysis pattern\n- pkg/orchestrator/context.go — RoadmapDoc, RoadmapRelease, RoadmapUseCase structs\n- pkg/orchestrator/stats.go — existing metrics pattern\n- magefiles/magefile.go — existing mage target structure\n- docs/road-map.yaml — roadmap structure with status fields\n- tests/rel01.0/ — test directory layout convention\n\nFiles to Create/Modify:\n- pkg/orchestrator/codestatus.go (new)\n- magefiles/magefile.go (add mage target)\n\nRequirements:\n1. Add scanTestDirectories() function that walks tests/ and discovers tests/rel{NN}.{N}/uc{NNN}/ directories, returning a map of use case IDs to test file paths\n2. Add computeCodeStatus() that takes the test directory scan and roadmap, returns per-use-case code status: \"implemented\" (test files exist), \"not started\" (no test directory)\n3. Add computeReleaseReadiness() that aggregates per-UC code status into per-release readiness: \"all implemented\", \"partial\", \"none\"\n4. Add detectSpecCodeGaps() that compares road-map.yaml spec status with code status, reporting mismatches\n5. Add CodeStatus() method on Orchestrator that runs the full check and prints a formatted report distinguishing \"specification done\" from \"code done\"\n6. Add mage target wiring (e.g., mage status or mage analyze:code)\n\nAcceptance Criteria:\n- Running the target scans tests/ and road-map.yaml, prints per-UC and per-release status\n- Output clearly shows spec status vs code status for each use case\n- Gaps are highlighted","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T13:35:06Z","created_by":"petardjukic","updated_at":"2026-02-26T13:37:47Z","closed_at":"2026-02-26T13:37:47Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-anw.2","depends_on_id":"cobbler-anw","type":"parent-child","created_at":"2026-02-26T08:35:06Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":21,"issue_id":"cobbler-anw.2","author":"petardjukic","text":"tokens: 45000","created_at":"2026-02-26T13:37:47Z"}]}
{"id":"cobbler-anw.3","title":"Add unit tests for code status detection","description":"deliverable_type: code\n\nRequired Reading:\n- pkg/orchestrator/codestatus.go — implementation from cobbler-anw.2\n- pkg/orchestrator/analyze_test.go — existing test patterns (t.TempDir(), table-driven tests)\n\nFiles to Create/Modify:\n- pkg/orchestrator/codestatus_test.go (new)\n\nRequirements:\n1. Test scanTestDirectories() with a temp dir containing mock test directory structures\n2. Test computeCodeStatus() with various roadmap + scan combinations\n3. Test computeReleaseReadiness() for all-implemented, partial, and none cases\n4. Test detectSpecCodeGaps() for matching and mismatching spec/code statuses\n5. Test edge cases: empty roadmap, no tests/ directory, releases with no use cases\n\nAcceptance Criteria:\n- All new functions have at least 3 test cases each\n- Edge cases (empty inputs, missing directories) are covered\n- mage test:unit passes","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T13:35:11Z","created_by":"petardjukic","updated_at":"2026-02-26T13:39:13Z","closed_at":"2026-02-26T13:39:13Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-anw.3","depends_on_id":"cobbler-anw","type":"parent-child","created_at":"2026-02-26T08:35:11Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":22,"issue_id":"cobbler-anw.3","author":"petardjukic","text":"tokens: 55000","created_at":"2026-02-26T13:39:12Z"}]}
{"id":"cobbler-cfn","title":"GH-38: generator:start and generator:stop should support non-main base branches","description":"generator:start enforces ensureOnBranch(\"main\") and generator:stop hardcodes gitCheckout(\"main\") as the merge target. This prevents running the generation pipeline on a feature branch.\n\nThe /git-issue-pop workflow creates a feature branch for each piece of work. Specifications are written on that branch, and the generation pipeline should run there too. The feature branch eventually merges into main via PR. But the current code forces the operator back to main for every generation run, breaking the feature-branch workflow.\n\nExpected: generator:start records the current branch as baseBranch and creates the generation branch from it. generator:stop merges back into the originating branch instead of hardcoded main.\n\nGitHub: petar-djukic/cobbler-scaffold#38","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T02:37:59Z","created_by":"petardjukic","updated_at":"2026-02-26T03:03:33Z","closed_at":"2026-02-26T03:03:33Z","close_reason":"Closed"}
{"id":"cobbler-cfn.2","title":"Update PRD and specs for base branch support","description":"Type: documentation\n\nRequired Reading:\n- docs/specs/product-requirements/prd002-generation-lifecycle.yaml\n- docs/specs/use-cases/rel01.0-uc002-generation-lifecycle.yaml\n- docs/specs/test-suites/test-rel01.0.yaml\n- docs/ARCHITECTURE.yaml\n\nFiles to Modify:\n- docs/specs/product-requirements/prd002-generation-lifecycle.yaml\n- docs/specs/use-cases/rel01.0-uc002-generation-lifecycle.yaml (or create a new use case)\n- docs/specs/test-suites/test-rel01.0.yaml\n\nRequirements:\n1. Update PRD R2.1 from \"must verify the current branch is main\" to \"must record the current branch as the base branch\" (any clean branch is valid).\n2. Update PRD R5.3 from \"must switch to main\" to \"must switch to the recorded base branch\".\n3. Add requirements for storing and reading the base branch name.\n4. Update or add a use case covering the feature-branch generation workflow.\n5. Update the test suite to cover the new behavior.\n\nAcceptance Criteria:\n- PRD requirements no longer hardcode \"main\" for start/stop base branch behavior.\n- A use case describes the feature-branch generation lifecycle.\n- Test suite has test cases for starting from a non-main branch and stopping back to it.\n- mage analyze passes after changes.","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T02:38:33Z","created_by":"petardjukic","updated_at":"2026-02-26T02:42:54Z","closed_at":"2026-02-26T02:42:54Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-cfn.2","depends_on_id":"cobbler-cfn","type":"parent-child","created_at":"2026-02-25T21:38:32Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":7,"issue_id":"cobbler-cfn.2","author":"petardjukic","text":"tokens: 45000","created_at":"2026-02-26T02:42:53Z"}]}
{"id":"cobbler-cfn.3","title":"Implement base branch recording in GeneratorStart/Stop","description":"Type: code\n\nRequired Reading:\n- pkg/orchestrator/generator.go (GeneratorStart, GeneratorStop, mergeGenerationIntoMain, ensureOnBranch)\n- pkg/orchestrator/commands.go (gitCurrentBranch, gitCheckout)\n- tests/rel01.0/uc002/lifecycle_test.go\n- docs/specs/product-requirements/prd002-generation-lifecycle.yaml (updated by sub-issue 1)\n\nFiles to Modify:\n- pkg/orchestrator/generator.go\n- tests/rel01.0/uc002/lifecycle_test.go\n\nRequirements:\n1. In GeneratorStart: replace ensureOnBranch(\"main\") with gitCurrentBranch(). Verify the branch is clean. Record the current branch name by writing it to .cobbler/base-branch on the generation branch (committed in the squash commit).\n2. In GeneratorStop: read .cobbler/base-branch from the generation branch. Use that value instead of hardcoded \"main\" for gitCheckout and merge target.\n3. Rename mergeGenerationIntoMain to mergeGeneration (or similar). Parameterize the target branch.\n4. Update log messages and commit messages to reference the base branch instead of \"main\".\n5. GeneratorReset keeps ensureOnBranch(\"main\") — no change.\n6. Update existing tests: TestRel01_UC002_StopMergesAndTags and TestRel01_UC002_StartStopStartAgain assert return to main because they start from main. Add a new test that starts from a feature branch, runs start/stop, and verifies return to the feature branch.\n7. All existing tests must continue to pass (main-based workflow is the default case).\n\nDesign Decisions:\n- Store base branch in .cobbler/base-branch (simple file, committed on generation branch, travels with the branch).\n- If .cobbler/base-branch is missing (backward compat with old generations), fall back to \"main\".\n\nAcceptance Criteria:\n- generator:start works from any clean branch and records it.\n- generator:stop merges back to the recorded base branch.\n- Existing main-based tests pass unchanged.\n- New test validates feature-branch workflow.\n- mage test:unit and mage test:local pass.","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T02:38:37Z","created_by":"petardjukic","updated_at":"2026-02-26T03:03:09Z","closed_at":"2026-02-26T03:03:09Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-cfn.3","depends_on_id":"cobbler-cfn","type":"parent-child","created_at":"2026-02-25T21:38:37Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":8,"issue_id":"cobbler-cfn.3","author":"petardjukic","text":"tokens: 85000","created_at":"2026-02-26T03:03:08Z"}]}
{"id":"cobbler-cpd","title":"GH-46: Extend mage analyze to validate all constitution schemas and requirement-level citations","description":"mage analyze currently validates YAML schemas for most document types but has two gaps:\n\n1. Constitution YAML files (design, execution, planning, testing, issue-format) lack typed structs and are silently skipped during schema validation. Embedded copies in pkg/orchestrator/constitutions/ are never checked for drift against docs/constitutions/.\n\n2. Requirement-level citations in use case touchpoints (e.g., R1, R3) are not validated against the actual requirements in the referenced PRD.\n\nGitHub: petar-djukic/cobbler-scaffold#46","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T04:31:23Z","created_by":"petardjukic","updated_at":"2026-02-26T04:51:07Z","closed_at":"2026-02-26T04:51:07Z","close_reason":"All children completed"}
{"id":"cobbler-cpd.1","title":"Add typed structs for constitution YAML files","description":"deliverable_type: code\nrequired_reading:\n  - pkg/orchestrator/context.go\n  - docs/constitutions/design.yaml\n  - docs/constitutions/execution.yaml\n  - docs/constitutions/planning.yaml\n  - docs/constitutions/testing.yaml\n  - pkg/orchestrator/constitutions/issue-format.yaml\nfiles:\n  - pkg/orchestrator/context.go\nrequirements: |\n  Create Go structs with yaml tags for design.yaml, execution.yaml,\n  planning.yaml, testing.yaml, and issue-format.yaml. Follow the\n  GoStyleDoc pattern. Each struct must parse the current YAML content\n  without error using KnownFields(true).\nacceptance_criteria: |\n  - All 5 constitutions have typed structs\n  - validateYAMLStrict succeeds for each on the current files\n  - Build passes","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T04:31:32Z","created_by":"petardjukic","updated_at":"2026-02-26T04:42:08Z","closed_at":"2026-02-26T04:42:08Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-cpd.1","depends_on_id":"cobbler-cpd","type":"parent-child","created_at":"2026-02-25T23:31:32Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":17,"issue_id":"cobbler-cpd.1","author":"petardjukic","text":"tokens: 45000","created_at":"2026-02-26T04:42:07Z"}]}
{"id":"cobbler-cpd.2","title":"Validate constitutions and detect embedded drift in analyze","description":"deliverable_type: code\nrequired_reading:\n  - pkg/orchestrator/analyze.go\n  - pkg/orchestrator/context.go\nfiles:\n  - pkg/orchestrator/analyze.go\nrequirements: |\n  1. Add case \"constitution\": to validateDocSchemas switch to validate\n     constitution files with their typed structs and KnownFields(true).\n  2. Validate all constitutions in both docs/constitutions/ and\n     pkg/orchestrator/constitutions/.\n  3. Add a new check: byte-compare each file that exists in both directories\n     and report drift as a new ConstitutionDrift field in AnalyzeResult.\n  4. Include drift results in printReport.\nacceptance_criteria: |\n  - mage analyze validates all constitution schemas\n  - Drift between docs/ and pkg/ copies is detected and reported\n  - mage analyze passes on current codebase","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T04:31:35Z","created_by":"petardjukic","updated_at":"2026-02-26T04:44:30Z","closed_at":"2026-02-26T04:44:30Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-cpd.2","depends_on_id":"cobbler-cpd","type":"parent-child","created_at":"2026-02-25T23:31:34Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":18,"issue_id":"cobbler-cpd.2","author":"petardjukic","text":"tokens: 15000","created_at":"2026-02-26T04:44:29Z"}]}
{"id":"cobbler-cpd.3","title":"Validate requirement-level citations in touchpoints","description":"deliverable_type: code\nrequired_reading:\n  - pkg/orchestrator/analyze.go\n  - docs/specs/use-cases/rel01.0-uc001-cupboard-lifecycle.yaml\n  - docs/specs/product-requirements/prd001-orchestrator-core.yaml\nfiles:\n  - pkg/orchestrator/analyze.go\nrequirements: |\n  1. Extend touchpoint parsing to extract requirement group IDs (R1, R3)\n     alongside PRD IDs from touchpoint strings.\n  2. Load PRD requirements into a map of requirement group keys per PRD.\n  3. Validate that cited requirement groups exist in the referenced PRD.\n  4. Report invalid citations as a new BrokenCitations field in AnalyzeResult.\n  5. Include broken citations in printReport.\nacceptance_criteria: |\n  - mage analyze detects citations to non-existent requirement groups\n  - Valid citations (current codebase) pass without error\n  - Invalid citations are reported with PRD ID and requirement group","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T04:31:41Z","created_by":"petardjukic","updated_at":"2026-02-26T04:49:06Z","closed_at":"2026-02-26T04:49:06Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-cpd.3","depends_on_id":"cobbler-cpd","type":"parent-child","created_at":"2026-02-25T23:31:41Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":19,"issue_id":"cobbler-cpd.3","author":"petardjukic","text":"tokens: 20000","created_at":"2026-02-26T04:49:06Z"}]}
{"id":"cobbler-cpd.4","title":"Add unit tests for new validation","description":"deliverable_type: code\nrequired_reading:\n  - pkg/orchestrator/cobbler_test.go\n  - pkg/orchestrator/analyze.go\nfiles:\n  - pkg/orchestrator/analyze_test.go\nrequirements: |\n  1. Test constitution struct parsing with valid and invalid YAML.\n  2. Test drift detection between matching and differing files.\n  3. Test requirement citation extraction and validation.\n  4. Test edge cases: missing files, unknown fields, valid citations,\n     broken citations, empty touchpoints.\nacceptance_criteria: |\n  - New tests pass\n  - Existing tests pass\n  - mage analyze passes on current codebase\n  - mage test:unit passes","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T04:31:42Z","created_by":"petardjukic","updated_at":"2026-02-26T04:50:45Z","closed_at":"2026-02-26T04:50:45Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-cpd.4","depends_on_id":"cobbler-cpd","type":"parent-child","created_at":"2026-02-25T23:31:41Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":20,"issue_id":"cobbler-cpd.4","author":"petardjukic","text":"tokens: 15000","created_at":"2026-02-26T04:50:45Z"}]}
{"id":"cobbler-d6r","title":"GH-49: Add release scope configuration to configuration.yaml","description":"Add a releases list field to configuration.yaml that specifies which releases are in scope for code generation. When set, the generator filters use cases to only those in the listed releases. Omitting the field preserves current behavior.\n\nGitHub: petar-djukic/cobbler-scaffold#49","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T22:33:04Z","created_by":"petardjukic","updated_at":"2026-02-26T22:40:18Z","closed_at":"2026-02-26T22:40:18Z","close_reason":"All children completed"}
{"id":"cobbler-d6r.2","title":"Add Releases list field to config, update release filtering and validation","description":"deliverable_type: code\n\nrequired_reading:\n  - pkg/orchestrator/config.go (ProjectConfig.Release field, LoadConfig)\n  - pkg/orchestrator/context.go (fileMatchesRelease, buildProjectContext, PhaseContext, loadContextFileInto)\n  - pkg/orchestrator/analyze.go (collectAnalyzeResult roadmap validation)\n\nfiles:\n  - path: pkg/orchestrator/config.go\n    action: modify\n    note: Replace Release string with Releases []string, add maxRelease helper, backward compat for release field\n  - path: pkg/orchestrator/context.go\n    action: modify\n    note: Update PhaseContext.Release to Releases, update fileMatchesRelease to accept list, update buildProjectContext to use Releases\n  - path: pkg/orchestrator/analyze.go\n    action: modify\n    note: Add validation that listed releases exist in road-map.yaml\n\nrequirements:\n  - id: R1\n    text: Add Releases list to ProjectConfig, deprecating the single Release string field\n  - id: R2\n    text: Update fileMatchesRelease to accept a list of releases and match files whose release is in the list or prior to the max listed release\n  - id: R3\n    text: Update buildProjectContext to use Releases for release scoping\n  - id: R4\n    text: Add release validation in collectAnalyzeResult — listed releases must exist in road-map.yaml\n  - id: R5\n    text: Omitting releases preserves current behavior (all releases in scope)\n\nacceptance_criteria:\n  - id: AC1\n    text: configuration.yaml accepts a releases list field\n  - id: AC2\n    text: Generator filters use cases by release scope\n  - id: AC3\n    text: Use cases from releases not in scope are excluded\n  - id: AC4\n    text: mage analyze validates that listed releases exist in road-map.yaml\n  - id: AC5\n    text: Omitting releases preserves current behavior","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T22:33:20Z","created_by":"petardjukic","updated_at":"2026-02-26T22:37:40Z","closed_at":"2026-02-26T22:37:40Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-d6r.2","depends_on_id":"cobbler-d6r","type":"parent-child","created_at":"2026-02-26T17:33:19Z","created_by":"petardjukic","metadata":"{}"}]}
{"id":"cobbler-d6r.3","title":"Add tests for release scope configuration","description":"deliverable_type: code\n\nrequired_reading:\n  - pkg/orchestrator/config.go (updated Releases field)\n  - pkg/orchestrator/context.go (updated fileMatchesRelease, buildProjectContext)\n  - pkg/orchestrator/context_test.go (existing fileMatchesRelease tests)\n  - pkg/orchestrator/analyze_test.go (existing analyze tests)\n\nfiles:\n  - path: pkg/orchestrator/context_test.go\n    action: modify\n    note: Tests for multi-release fileMatchesRelease, buildProjectContext with Releases\n  - path: pkg/orchestrator/config_test.go\n    action: modify\n    note: Tests for Releases field loading, backward compat\n  - path: pkg/orchestrator/analyze_test.go\n    action: modify\n    note: Tests for release validation against roadmap\n\nrequirements:\n  - id: R1\n    text: Test fileMatchesRelease with multiple releases\n  - id: R2\n    text: Test buildProjectContext filters use cases correctly with Releases\n  - id: R3\n    text: Test that omitting Releases includes all releases\n  - id: R4\n    text: Test that invalid releases in config are caught by analyze\n  - id: R5\n    text: Test backward compatibility (single release field still works)\n\nacceptance_criteria:\n  - id: AC1\n    text: All new tests pass\n  - id: AC2\n    text: Existing tests still pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T22:33:26Z","created_by":"petardjukic","updated_at":"2026-02-26T22:40:14Z","closed_at":"2026-02-26T22:40:14Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-d6r.3","depends_on_id":"cobbler-d6r","type":"parent-child","created_at":"2026-02-26T17:33:25Z","created_by":"petardjukic","metadata":"{}"}]}
{"id":"cobbler-dvv","title":"GH-40: Recurring: Run mage test:usecase and fix failures","description":"Run the use case test suite (mage test:usecase) against the current cobbler-scaffold codebase, identify failures, and fix them. This is a recurring task — create a new instance after each run.\n\nProtocol:\n1. Run the test suite: mage test:usecase\n2. Record results: total test cases, pass/fail counts, failure details\n3. Triage failures: regression, known issue, or new bug\n4. Fix failures: fix regressions in-place, file issues for non-trivial new bugs\n5. Report: date, pass rate, failures fixed, issues filed\n\nGitHub: petar-djukic/cobbler-scaffold#40","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:58:34Z","created_by":"petardjukic","updated_at":"2026-02-26T04:13:19Z","closed_at":"2026-02-26T04:13:19Z","close_reason":"All children completed"}
{"id":"cobbler-dvv.1","title":"Run test:usecase and record results","description":"deliverable_type: code\nrequired_reading:\n  - magefiles/test.go\n  - docs/specs/test-suites/\nfiles:\n  - (none — this is a run-and-record task)\nrequirements: |\n  Run mage test:usecase against the current codebase. Record:\n  - Total test cases run\n  - Pass/fail counts\n  - Failure details: which use case, what assertion failed, error output\n  Save results for triage in the next sub-issue.\nacceptance_criteria: |\n  - mage test:usecase has been executed\n  - Results are captured with pass/fail counts and failure details","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:58:41Z","created_by":"petardjukic","updated_at":"2026-02-26T04:04:35Z","closed_at":"2026-02-26T04:04:35Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-dvv.1","depends_on_id":"cobbler-dvv","type":"parent-child","created_at":"2026-02-25T22:58:40Z","created_by":"petardjukic","metadata":"{}"}]}
{"id":"cobbler-dvv.2","title":"Triage and fix test failures","description":"deliverable_type: code\nrequired_reading:\n  - magefiles/test.go\n  - pkg/orchestrator/\n  - docs/specs/use-cases/\nfiles:\n  - pkg/orchestrator/ (files with failing tests)\n  - magefiles/ (if test harness needs fixes)\nrequirements: |\n  For each failing test case from sub-issue 1:\n  - Classify as regression, known issue, or new bug\n  - Fix regressions and straightforward bugs in-place\n  - File GitHub issues for non-trivial new bugs\n  - Re-run mage test:usecase to confirm fixes\nacceptance_criteria: |\n  - All failures triaged\n  - Regressions and simple bugs fixed\n  - Non-trivial bugs have GitHub issues filed\n  - mage test:usecase re-run confirms fixes (or remaining failures have tracked issues)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:58:45Z","created_by":"petardjukic","updated_at":"2026-02-26T04:12:56Z","closed_at":"2026-02-26T04:12:56Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-dvv.2","depends_on_id":"cobbler-dvv","type":"parent-child","created_at":"2026-02-25T22:58:44Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":15,"issue_id":"cobbler-dvv.2","author":"petardjukic","text":"tokens: 50000","created_at":"2026-02-26T04:12:56Z"}]}
{"id":"cobbler-dvv.3","title":"Report results and close","description":"deliverable_type: code\nrequired_reading:\n  - (results from previous sub-issues)\nfiles:\n  - (commit messages and issue comments)\nrequirements: |\n  Document the test run results:\n  - Date, pass rate, failures fixed, issues filed\n  - Commit all changes with stats\n  - Close the epic and trigger Phase 5 (PR creation)\nacceptance_criteria: |\n  - Test run results documented\n  - All changes committed with stats\n  - Epic closed, PR opened against main","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:58:48Z","created_by":"petardjukic","updated_at":"2026-02-26T04:13:19Z","closed_at":"2026-02-26T04:13:19Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-dvv.3","depends_on_id":"cobbler-dvv","type":"parent-child","created_at":"2026-02-25T22:58:47Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":16,"issue_id":"cobbler-dvv.3","author":"petardjukic","text":"tokens: 10000","created_at":"2026-02-26T04:13:18Z"}]}
{"id":"cobbler-k4t","title":"GH-53: context_include bypasses Vision/Architecture/Roadmap structured parsing","description":"When context_include is set, buildProjectContext replaces standard file resolution. Vision, Architecture, and Roadmap documents lose typed parsing — loaded as generic NamedDoc entries or silently dropped. Additionally, markdown files fail YAML parsing silently. Fix by ensuring standard typed documents are always loaded regardless of context_include patterns, and handle non-YAML files gracefully.\n\nGitHub: petar-djukic/cobbler-scaffold#53","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T21:24:04Z","created_by":"petardjukic","updated_at":"2026-02-26T21:28:46Z","closed_at":"2026-02-26T21:28:46Z","close_reason":"All children completed"}
{"id":"cobbler-k4t.1","title":"Ensure standard typed documents are always loaded when context_include is set","description":"deliverable_type: code\n\nrequired_reading:\n  - pkg/orchestrator/context.go (buildProjectContext, resolveStandardFiles, classifyContextFile, loadContextFileInto, loadNamedDoc)\n\nfiles:\n  - path: pkg/orchestrator/context.go\n    action: modify\n    note: Add ensureTypedDocs to merge standard typed docs into context_include set; fix loadNamedDoc for non-YAML\n\nrequirements:\n  - id: R1\n    text: After resolving context_include files, check if core typed documents exist on disk and add them if missing from resolved set\n  - id: R2\n    text: Modify loadNamedDoc to handle non-YAML files by loading as raw text instead of silently dropping\n  - id: R3\n    text: context_include path must produce vision=true arch=true roadmap=true when those files exist\n\nacceptance_criteria:\n  - id: AC1\n    text: buildProjectContext with context_include logs vision=true arch=true roadmap=true when files exist\n  - id: AC2\n    text: Markdown files loaded via context_include are not silently dropped\n  - id: AC3\n    text: Existing tests pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T21:24:12Z","created_by":"petardjukic","updated_at":"2026-02-26T21:26:39Z","closed_at":"2026-02-26T21:26:39Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-k4t.1","depends_on_id":"cobbler-k4t","type":"parent-child","created_at":"2026-02-26T16:24:11Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":27,"issue_id":"cobbler-k4t.1","author":"petardjukic","text":"tokens: 40000","created_at":"2026-02-26T21:26:39Z"}]}
{"id":"cobbler-k4t.2","title":"Add unit tests for context_include typed document loading","description":"deliverable_type: code\n\nrequired_reading:\n  - pkg/orchestrator/context.go (buildProjectContext, loadNamedDoc, classifyContextFile)\n  - pkg/orchestrator/context_test.go (existing context tests)\n\nfiles:\n  - path: pkg/orchestrator/context_test.go\n    action: modify\n    note: Tests for typed doc loading with context_include and markdown handling\n\nrequirements:\n  - id: R1\n    text: Test buildProjectContext with context_include still loads Vision when file exists\n  - id: R2\n    text: Test loadNamedDoc handles markdown files without returning nil\n  - id: R3\n    text: Test classifyContextFile returns correct types for all known document paths\n\nacceptance_criteria:\n  - id: AC1\n    text: All new tests pass\n  - id: AC2\n    text: Full test suite passes","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T21:24:18Z","created_by":"petardjukic","updated_at":"2026-02-26T21:28:29Z","closed_at":"2026-02-26T21:28:29Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-k4t.2","depends_on_id":"cobbler-k4t","type":"parent-child","created_at":"2026-02-26T16:24:17Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":28,"issue_id":"cobbler-k4t.2","author":"petardjukic","text":"tokens: 20000","created_at":"2026-02-26T21:28:28Z"}]}
{"id":"cobbler-qwj","title":"GH-33: Cross-generation differential comparison via mage compare","description":"Add a mage compare \u003ctag-A\u003e \u003ctag-B\u003e [utility] target that builds binaries from two git tags and runs differential tests between them. Enables cross-generation regression testing: comparing generation N against generation N+1, or any generation against GNU reference binaries.\n\nKey components:\n- BinaryResolver interface with GitTagResolver, GNUResolver, PathResolver implementations\n- Test case loader from YAML spec test suites\n- Comparison runner with structured pass/fail output\n- mage compare:run target\n\nGitHub: petar-djukic/cobbler-scaffold#33","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T02:07:02Z","created_by":"petardjukic","updated_at":"2026-02-26T02:27:14Z","closed_at":"2026-02-26T02:27:14Z","close_reason":"All children completed"}
{"id":"cobbler-qwj.1","title":"PRD and use case for differential comparison","description":"## Required Reading\n- docs/VISION.yaml\n- docs/ARCHITECTURE.yaml\n- docs/constitutions/design.yaml (document_types: prd-format, use-case-format)\n- docs/road-map.yaml\n- docs/specs/product-requirements/prd001-orchestrator-core.yaml (pattern reference)\n- docs/specs/product-requirements/prd003-cobbler-workflows.yaml (pattern reference)\n- docs/specs/use-cases/rel01.0-uc004-stitch-workflow.yaml (pattern reference)\n- docs/engineering/golden-example-measure.yaml (references prd004)\n- docs/SPECIFICATIONS.yaml (notes prd004 gap)\n\n## Files to Create\n- docs/specs/product-requirements/prd004-differential-comparison.yaml\n- docs/specs/use-cases/rel03.0-uc001-cross-generation-comparison.yaml\n\n## Files to Modify\n- docs/road-map.yaml (add rel03.0 with uc001)\n\n## Requirements\n1. PRD covers: BinaryResolver interface, GitTag/GNU/Path resolver implementations, test case loading from YAML specs, comparison execution, structured output, worktree cleanup\n2. Use case covers: compare two generation tags, compare against GNU reference, single-utility comparison, structured result reporting\n3. Road-map updated with rel03.0 containing the new use case\n4. Fill the prd004 numbering gap noted in SPECIFICATIONS.yaml\n\n## Design Decisions\n- Follow existing PRD format (prd-format from design.yaml)\n- Number requirements R1-R6 covering: resolver interface, git tag resolution, GNU resolution, test case loading, comparison execution, output formatting\n- Use case follows existing pattern with preconditions, flow steps, success criteria, and touchpoints tracing to PRD requirements\n\n## Acceptance Criteria\n- mage analyze passes (no orphaned PRDs, use case in roadmap, traces valid)\n- PRD traces to VISION and ARCHITECTURE\n- Use case traces to PRD via touchpoints\n- road-map.yaml includes rel03.0","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T02:07:14Z","created_by":"petardjukic","updated_at":"2026-02-26T02:19:47Z","closed_at":"2026-02-26T02:19:47Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-qwj.1","depends_on_id":"cobbler-qwj","type":"parent-child","created_at":"2026-02-25T21:07:14Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":3,"issue_id":"cobbler-qwj.1","author":"petardjukic","text":"tokens: 0","created_at":"2026-02-26T02:19:46Z"}]}
{"id":"cobbler-qwj.2","title":"BinaryResolver interface and implementations","description":"## Required Reading\n- docs/specs/product-requirements/prd004-differential-comparison.yaml (created in sub-issue 1)\n- pkg/orchestrator/commands.go (git worktree wrappers: gitWorktreeAdd, gitWorktreeRemove)\n- pkg/orchestrator/build.go (go build patterns)\n- pkg/orchestrator/config.go (Config struct, project settings)\n- pkg/orchestrator/stitch.go (worktree lifecycle pattern)\n\n## Files to Create\n- pkg/orchestrator/compare.go\n\n## Requirements\n1. BinaryResolver interface: Resolve(utility string) (path string, cleanup func(), err error)\n2. GitTagResolver{Tag string}: creates temp worktree from git tag, discovers cmd/ packages, builds each with go build, returns binary path. cleanup removes worktree and temp build dir.\n3. GNUResolver{}: resolves Homebrew reference binaries via exec.LookPath. Coreutils use g-prefix (cat-\u003egcat, wc-\u003egwc). Moreutils use unprefixed names (ts-\u003ets, sponge-\u003esponge). Returns binary path on PATH; cleanup is no-op.\n4. PathResolver{Dir string}: resolves pre-built binaries from a directory. Returns filepath.Join(Dir, utility); cleanup is no-op.\n5. ResolverFromArg(arg string) BinaryResolver: factory that selects resolver based on argument — \"gnu\" -\u003e GNUResolver, directory path -\u003e PathResolver, otherwise -\u003e GitTagResolver.\n6. ListUtilities(resolver BinaryResolver) ([]string, error): discovers available utilities for a resolver.\n\n## Design Decisions\n- Use existing gitWorktreeAdd/Remove from commands.go for worktree lifecycle\n- GitTagResolver builds into a temp directory (os.MkdirTemp), not into the worktree itself\n- GNUResolver maintains a map of utility -\u003e binary name for the g-prefix convention\n- cleanup functions are idempotent (safe to call multiple times)\n\n## Acceptance Criteria\n- All three resolvers compile and handle errors with wrapped context\n- GitTagResolver creates and cleans up worktrees\n- GNUResolver resolves coreutils and moreutils correctly\n- PathResolver validates binary exists at path\n- Code compiles: go build ./...","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T02:07:29Z","created_by":"petardjukic","updated_at":"2026-02-26T02:21:04Z","closed_at":"2026-02-26T02:21:04Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-qwj.2","depends_on_id":"cobbler-qwj","type":"parent-child","created_at":"2026-02-25T21:07:29Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":4,"issue_id":"cobbler-qwj.2","author":"petardjukic","text":"tokens: 0","created_at":"2026-02-26T02:21:03Z"}]}
{"id":"cobbler-qwj.3","title":"Test case loader and comparison runner","description":"## Required Reading\n- docs/specs/product-requirements/prd004-differential-comparison.yaml\n- docs/specs/test-suites/test-rel01.0.yaml (test suite YAML structure)\n- pkg/orchestrator/context.go (YAML loading patterns)\n- pkg/orchestrator/compare.go (BinaryResolver interface, created in sub-issue 2)\n\n## Files to Create\n- pkg/orchestrator/testloader.go\n\n## Requirements\n1. TestCase struct modeling a test case from YAML specs: name, utility, stdin input, args, expected stdout, expected stderr, expected exit code.\n2. LoadTestCases(specsDir string) ([]TestCase, error): reads test suite YAML files from docs/specs/test-suites/, extracts test cases with inputs and expected outputs. Filters to cases that have concrete inputs/expected (skips Go-test-only entries).\n3. FilterByUtility(cases []TestCase, utility string) []TestCase: filters test cases to a single utility.\n4. CompareUtility(binA, binB string, cases []TestCase) []TestResult: runs both binaries with identical inputs for each test case, compares stdout byte-for-byte, stderr, and exit code.\n5. TestResult struct: utility, test name, passed bool, expected/actual diffs for stdout/stderr/exit code.\n6. FormatResults(results []TestResult) string: structured text output showing pass/fail per utility per test case with summary counts.\n\n## Design Decisions\n- Test cases loaded from YAML specs (not from _test.go files) so any two implementations can be compared\n- Comparison is byte-for-byte on stdout; stderr and exit code compared separately\n- Each test case executed with a timeout (configurable, default 10s)\n- Results collected in memory, formatted at the end (not streamed)\n\n## Acceptance Criteria\n- Loader parses existing test-rel01.0.yaml structure\n- CompareUtility produces correct pass/fail for matching and differing outputs\n- FormatResults produces readable structured output\n- Code compiles: go build ./...","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T02:07:44Z","created_by":"petardjukic","updated_at":"2026-02-26T02:24:18Z","closed_at":"2026-02-26T02:24:18Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-qwj.3","depends_on_id":"cobbler-qwj","type":"parent-child","created_at":"2026-02-25T21:07:43Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":5,"issue_id":"cobbler-qwj.3","author":"petardjukic","text":"tokens: 12000","created_at":"2026-02-26T02:24:18Z"}]}
{"id":"cobbler-qwj.4","title":"Mage target, orchestrator method, and tests","description":"## Required Reading\n- docs/specs/product-requirements/prd004-differential-comparison.yaml\n- magefiles/magefile.go (namespace pattern, newOrch(), target signatures)\n- pkg/orchestrator/orchestrator.go (Orchestrator struct, public methods)\n- pkg/orchestrator/compare.go (BinaryResolver, resolvers)\n- pkg/orchestrator/testloader.go (LoadTestCases, CompareUtility, FormatResults)\n\n## Files to Create\n- pkg/orchestrator/compare_test.go\n\n## Files to Modify\n- magefiles/magefile.go (add Compare namespace and Run target)\n\n## Requirements\n1. Compare method on Orchestrator: Compare(tagA, tagB, utility string) error\n   - Creates resolvers for both arguments via ResolverFromArg\n   - Loads test cases from specs dir\n   - Optionally filters by utility\n   - Discovers utilities from both resolvers, intersects to find common set\n   - For each common utility: resolves both binaries, runs comparison, collects results\n   - Cleans up all resolver resources (deferred)\n   - Formats and prints results; returns error if any test failed\n2. Compare mage namespace with Run target:\n   type Compare mg.Namespace\n   func (Compare) Run(tagA, tagB string) error — compares all utilities\n   Utility filtering via environment variable or additional target\n3. Unit tests for:\n   - PathResolver (create temp binaries, verify resolution)\n   - GNUResolver (verify g-prefix mapping for known utilities)\n   - ResolverFromArg (factory selection logic)\n   - FormatResults (output formatting)\n4. Integration test (if git available): GitTagResolver with a known tag\n\n## Design Decisions\n- Compare method lives on Orchestrator for access to config (specs dir, source dirs)\n- Mage target uses environment variable UTILITY for single-utility filtering (mage limitation: no optional positional args)\n- Tests use PathResolver with temp dirs to avoid git/build dependencies in unit tests\n- Integration tests gated on environment (skip if no git repo)\n\n## Acceptance Criteria\n- go build ./... passes\n- go test ./pkg/orchestrator/ passes (new tests)\n- mage -l shows compare:run target\n- mage compare:run \u003ctagA\u003e \u003ctagB\u003e executes end-to-end (manual verification)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T02:08:00Z","created_by":"petardjukic","updated_at":"2026-02-26T02:26:29Z","closed_at":"2026-02-26T02:26:29Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-qwj.4","depends_on_id":"cobbler-qwj","type":"parent-child","created_at":"2026-02-25T21:08:00Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":6,"issue_id":"cobbler-qwj.4","author":"petardjukic","text":"tokens: 15000","created_at":"2026-02-26T02:26:28Z"}]}
{"id":"cobbler-qwo","title":"GH-39: Full requirements coverage, test coverage, and code inspection audit","description":"Perform a comprehensive audit of the cobbler-scaffold codebase covering requirements traceability, test coverage, and code quality. This is a recurring task — create a new instance after each audit.\n\nAudit Protocol:\n1. Requirements Coverage - Review all GitHub issues, check feature tests, identify undocumented behavior\n2. Test Coverage - Run go test -cover, identify untested code paths\n3. Code Inspection - Error handling, hardcoded assumptions, race conditions, resource cleanup\n4. Cross-Repository Consistency - Verify symlinked magefiles, configuration.yaml schema\n\nGitHub: petar-djukic/cobbler-scaffold#39","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:13:02Z","created_by":"petardjukic","updated_at":"2026-02-26T04:13:19Z","closed_at":"2026-02-26T04:13:19Z","close_reason":"All children completed"}
{"id":"cobbler-qwo.2","title":"Requirements coverage audit","description":"Type: documentation\n\nRequired Reading:\n- All closed GitHub issues (via gh issue list --state closed)\n- docs/specs/product-requirements/*.yaml\n- docs/specs/use-cases/*.yaml\n- magefiles/magefile.go\n- docs/road-map.yaml\n\nFiles to Create:\n- docs/audits/audit-2026-02-25-requirements.yaml\n\nRequirements:\n- Cross-reference every closed GitHub issue against implemented code and specs\n- Identify mage targets without corresponding PRD requirements\n- Check for undocumented behavior (code paths with no requirement or issue)\n- Verify that closed issues are actually implemented, not just closed\n\nAcceptance Criteria:\n- Every closed issue verified as implemented or documented as gap\n- Every mage target traced to a PRD requirement\n- Gaps filed as new GitHub issues","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:13:51Z","created_by":"petardjukic","updated_at":"2026-02-26T03:19:23Z","closed_at":"2026-02-26T03:19:23Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-qwo.2","depends_on_id":"cobbler-qwo","type":"parent-child","created_at":"2026-02-25T22:13:51Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":9,"issue_id":"cobbler-qwo.2","author":"petardjukic","text":"tokens: 120000","created_at":"2026-02-26T03:19:22Z"}]}
{"id":"cobbler-qwo.3","title":"Test coverage analysis and gap filling","description":"Type: code\n\nRequired Reading:\n- pkg/orchestrator/*.go\n- pkg/orchestrator/*_test.go\n- magefiles/magefile.go\n\nFiles to Create/Modify:\n- docs/audits/audit-2026-02-25-coverage.yaml\n- pkg/orchestrator/*_test.go (new tests for gaps)\n\nRequirements:\n- Run go test -cover ./... and record per-package coverage\n- Identify untested code paths in generator, stitch, measure, tag, and compare\n- Identify edge cases: timeout, merge conflict, missing config\n- Write missing unit tests for the highest-severity gaps\n\nAcceptance Criteria:\n- Per-package coverage percentages recorded\n- Top untested paths identified with severity\n- At least 3 new unit tests added for high-severity gaps","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:13:54Z","created_by":"petardjukic","updated_at":"2026-02-26T03:25:15Z","closed_at":"2026-02-26T03:25:15Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-qwo.3","depends_on_id":"cobbler-qwo","type":"parent-child","created_at":"2026-02-25T22:13:54Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":10,"issue_id":"cobbler-qwo.3","author":"petardjukic","text":"tokens: 80000","created_at":"2026-02-26T03:25:15Z"}]}
{"id":"cobbler-qwo.4","title":"Code inspection: error handling and resource cleanup","description":"Type: code\n\nRequired Reading:\n- pkg/orchestrator/generator.go\n- pkg/orchestrator/stitch.go\n- pkg/orchestrator/measure.go\n- pkg/orchestrator/tag.go\n- pkg/orchestrator/compare.go\n\nFiles to Modify:\n- Production code files where issues are found\n\nRequirements:\n- Review error propagation for silent failures\n- Check resource cleanup (worktrees, temp dirs, processes)\n- Check for hardcoded assumptions (main branch, directory names)\n- Review logging for traceability\n\nAcceptance Criteria:\n- All silent error swallowing fixed\n- Resource cleanup verified or corrected\n- Hardcoded assumptions documented or parameterized\n- No new issues introduced","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:13:59Z","created_by":"petardjukic","updated_at":"2026-02-26T03:29:20Z","closed_at":"2026-02-26T03:29:20Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-qwo.4","depends_on_id":"cobbler-qwo","type":"parent-child","created_at":"2026-02-25T22:13:58Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":11,"issue_id":"cobbler-qwo.4","author":"petardjukic","text":"tokens: 60000","created_at":"2026-02-26T03:29:20Z"}]}
{"id":"cobbler-qwo.5","title":"Code inspection: concurrency and configuration","description":"Type: code\n\nRequired Reading:\n- pkg/orchestrator/stitch.go\n- pkg/orchestrator/orchestrator.go\n- pkg/orchestrator/config.go\n- configuration.yaml (template)\n\nFiles to Modify:\n- Production code files where issues are found\n\nRequirements:\n- Check for race conditions in parallel stitch and worktree management\n- Verify all configuration.yaml fields are consumed (no dead config)\n- Check that config schema matches code expectations\n\nAcceptance Criteria:\n- Race conditions identified and fixed or documented\n- Dead config fields removed\n- Config schema consistent between template and code","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:14:02Z","created_by":"petardjukic","updated_at":"2026-02-26T03:50:49Z","closed_at":"2026-02-26T03:50:49Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-qwo.5","depends_on_id":"cobbler-qwo","type":"parent-child","created_at":"2026-02-25T22:14:01Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":12,"issue_id":"cobbler-qwo.5","author":"petardjukic","text":"tokens: 50000","created_at":"2026-02-26T03:50:48Z"}]}
{"id":"cobbler-qwo.6","title":"Cross-repository consistency check","description":"Type: documentation\n\nRequired Reading:\n- magefiles/magefile.go\n- pkg/orchestrator/scaffold.go\n- Consumer repo configuration (go-unix-utils)\n\nFiles to Create:\n- docs/audits/audit-2026-02-25-crossrepo.yaml\n\nRequirements:\n- Verify scaffold:push produces a working orchestrator.go in consumer repos\n- Verify configuration.yaml schema matches code expectations\n- Check mage targets work when symlinked\n\nAcceptance Criteria:\n- Scaffold push verified\n- Config schema documented\n- Any discrepancies filed as issues","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:14:06Z","created_by":"petardjukic","updated_at":"2026-02-26T03:52:42Z","closed_at":"2026-02-26T03:52:42Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-qwo.6","depends_on_id":"cobbler-qwo","type":"parent-child","created_at":"2026-02-25T22:14:06Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":13,"issue_id":"cobbler-qwo.6","author":"petardjukic","text":"tokens: 40000","created_at":"2026-02-26T03:52:42Z"}]}
{"id":"cobbler-qwo.7","title":"Audit summary and issue filing","description":"Type: documentation\n\nRequired Reading:\n- Outputs from sub-issues 1-5\n- docs/audits/audit-2026-02-25-*.yaml\n\nFiles to Create:\n- docs/audits/audit-2026-02-25-summary.yaml\n\nRequirements:\n- Consolidate findings into a summary report\n- File new GitHub issues for all problems found\n- Record coverage trend baseline for future audits\n\nAcceptance Criteria:\n- Summary report complete\n- All findings have corresponding GitHub issues\n- Coverage baseline recorded for future audits","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T03:14:08Z","created_by":"petardjukic","updated_at":"2026-02-26T03:53:28Z","closed_at":"2026-02-26T03:53:28Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-qwo.7","depends_on_id":"cobbler-qwo","type":"parent-child","created_at":"2026-02-25T22:14:08Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":14,"issue_id":"cobbler-qwo.7","author":"petardjukic","text":"tokens: 30000","created_at":"2026-02-26T03:53:27Z"}]}
{"id":"cobbler-sko","title":"GH-52: Measure agent re-proposes completed work across cycles","description":"The measure agent repeatedly re-proposes work that was already completed by the stitch agent in prior cycles. Three factors compound: (1) measure prompt lacks closed-issue semantics, (2) ARCHITECTURE.yaml prose overrides source code evidence, (3) enforce_measure_validation: false removes the safety net. Fix by adding completed-work summary to context and strengthening deduplication constraints in measure prompt.\n\nGitHub: petar-djukic/cobbler-scaffold#52","status":"closed","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T19:34:28Z","created_by":"petardjukic","updated_at":"2026-02-26T19:38:25Z","closed_at":"2026-02-26T19:38:25Z","close_reason":"All children completed"}
{"id":"cobbler-sko.1","title":"Add completed-work summary to measure prompt and strengthen deduplication constraints","description":"deliverable_type: code\n\nrequired_reading:\n  - pkg/orchestrator/prompts/measure.yaml (current measure prompt constraints)\n  - pkg/orchestrator/measure.go (getExistingIssues, buildMeasurePrompt)\n  - pkg/orchestrator/commands.go (bdListClosedTasks)\n  - pkg/orchestrator/context.go (ProjectContext, ContextIssue, buildProjectContext)\n\nfiles:\n  - path: pkg/orchestrator/prompts/measure.yaml\n    action: modify\n    note: Add closed-issue deduplication constraints\n  - path: pkg/orchestrator/measure.go\n    action: modify\n    note: Build completed-work summary from bdListClosedTasks\n  - path: pkg/orchestrator/context.go\n    action: modify\n    note: Add CompletedWork field to ProjectContext\n\nrequirements:\n  - id: R1\n    text: Add CompletedWork []string field to ProjectContext summarizing closed issues\n  - id: R2\n    text: Populate CompletedWork in buildMeasurePrompt from bdListClosedTasks()\n  - id: R3\n    text: Update measure.yaml constraints with explicit closed-issue semantics\n  - id: R4\n    text: Add constraint about checking source_code for existing implementations\n\nacceptance_criteria:\n  - id: AC1\n    text: MeasurePrompt output includes completed_work section when closed issues exist\n  - id: AC2\n    text: Constraints contain explicit closed-issue deduplication guidance\n  - id: AC3\n    text: Existing tests pass","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T19:34:36Z","created_by":"petardjukic","updated_at":"2026-02-26T19:36:17Z","closed_at":"2026-02-26T19:36:17Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-sko.1","depends_on_id":"cobbler-sko","type":"parent-child","created_at":"2026-02-26T14:34:36Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":25,"issue_id":"cobbler-sko.1","author":"petardjukic","text":"tokens: 30000","created_at":"2026-02-26T19:36:17Z"}]}
{"id":"cobbler-sko.2","title":"Add unit tests for completed-work deduplication","description":"deliverable_type: code\n\nrequired_reading:\n  - pkg/orchestrator/measure.go (buildMeasurePrompt, getCompletedWork)\n  - pkg/orchestrator/context.go (ProjectContext.CompletedWork)\n  - pkg/orchestrator/prompt_test.go (existing prompt tests)\n\nfiles:\n  - path: pkg/orchestrator/measure_test.go\n    action: modify\n    note: Tests for completed-work assembly and prompt inclusion\n\nrequirements:\n  - id: R1\n    text: Test buildMeasurePrompt includes completed_work when closed tasks exist\n  - id: R2\n    text: Test CompletedWork is empty when no closed tasks exist\n  - id: R3\n    text: Test measure prompt constraints contain closed-issue dedup language\n\nacceptance_criteria:\n  - id: AC1\n    text: All new tests pass\n  - id: AC2\n    text: Full test suite passes","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T19:34:42Z","created_by":"petardjukic","updated_at":"2026-02-26T19:38:09Z","closed_at":"2026-02-26T19:38:09Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-sko.2","depends_on_id":"cobbler-sko","type":"parent-child","created_at":"2026-02-26T14:34:41Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":26,"issue_id":"cobbler-sko.2","author":"petardjukic","text":"tokens: 15000","created_at":"2026-02-26T19:38:08Z"}]}
